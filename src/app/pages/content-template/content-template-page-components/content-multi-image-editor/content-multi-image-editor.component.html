<mat-card *ngIf="multiImage" style="box-shadow: var(--mat-elevation-2, 0 2px 4px rgba(0,0,0,0.10)); border-radius: 12px; margin-bottom: 1.5rem;">
  <mat-card-header>
    <mat-card-title style="font-size: 1.1rem; font-weight: 500;">Multi-Image Settings</mat-card-title>
  </mat-card-header>
  <mat-divider></mat-divider>
  <mat-card-content style="display: flex; flex-direction: column; gap: 1rem;">
    <mat-form-field appearance="outline">
      <mat-label>Minimum Images</mat-label>
      <input matInput type="number" [(ngModel)]="multiImage.minImages" (ngModelChange)="onMultiImageChange()" name="minImages" min="1" required>
    </mat-form-field>
    <mat-form-field appearance="outline">
      <mat-label>Maximum Images</mat-label>
      <input matInput type="number" [(ngModel)]="multiImage.maxImages" (ngModelChange)="onMultiImageChange()" name="maxImages" min="1" required>
    </mat-form-field>
    <div class="images-list" style="margin-top: 1.5rem; display: flex; flex-direction: column; gap: 1.5rem;">
      <h4 style="margin-bottom: 0.5rem;">Images</h4>
      <ng-container *ngFor="let img of multiImage.images; let i = index">
        <mat-card class="image-card" style="margin-bottom: 1rem; box-shadow: var(--mat-elevation-1, 0 1px 3px rgba(0,0,0,0.12));">
          <mat-card-header>
            <mat-card-title>Image {{ i + 1 }}</mat-card-title>
            <button mat-icon-button color="warn" (click)="removeImage(i)" [disabled]="!multiImage.images || multiImage.images.length <= 1" matTooltip="Remove Image">
              <mat-icon>delete</mat-icon>
            </button>
          </mat-card-header>
          <mat-divider></mat-divider>
          <mat-card-content style="display: flex; flex-direction: column; gap: 1rem;">
            <mat-form-field appearance="outline">
              <mat-label>Set URL</mat-label>
              <input matInput [(ngModel)]="img.setUrl" (ngModelChange)="onMultiImageChange()" name="imageSetUrl{{i}}" placeholder="https://...">
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Media Type</mat-label>
              <mat-select [(ngModel)]="img.mediaType" (selectionChange)="onMultiImageChange()" name="imageMediaType{{i}}">
                <mat-option *ngFor="let type of mediaTypes" [value]="type">{{ type }}</mat-option>
              </mat-select>
            </mat-form-field>
            <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
              <mat-form-field appearance="outline" *ngIf="img.dimensions" style="flex: 1 1 120px; min-width: 120px;">
                <mat-label>Width (px)</mat-label>
                <input matInput type="number" [(ngModel)]="img.dimensions.width" (ngModelChange)="onMultiImageChange()" name="imageWidth{{i}}" min="1">
              </mat-form-field>
              <mat-form-field appearance="outline" *ngIf="img.dimensions" style="flex: 1 1 120px; min-width: 120px;">
                <mat-label>Height (px)</mat-label>
                <input matInput type="number" [(ngModel)]="img.dimensions.height" (ngModelChange)="onMultiImageChange()" name="imageHeight{{i}}" min="1">
              </mat-form-field>
              <mat-form-field appearance="outline" *ngIf="img.dimensions" style="flex: 1 1 120px; min-width: 120px;">
                <mat-label>Aspect Ratio</mat-label>
                <mat-select [(ngModel)]="img.dimensions.aspectRatio" (selectionChange)="onMultiImageChange()" name="imageAspectRatio{{i}}">
                  <mat-option *ngFor="let ratio of aspectRatios" [value]="ratio.value">{{ ratio.label }}</mat-option>
                </mat-select>
              </mat-form-field>
            </div>
            <mat-form-field appearance="outline">
              <mat-label>Resolution</mat-label>
              <input matInput [(ngModel)]="img.resolution" (ngModelChange)="onMultiImageChange()" name="imageResolution{{i}}" placeholder="e.g. 300dpi">
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Format</mat-label>
              <mat-select [(ngModel)]="img.format" (selectionChange)="onMultiImageChange()" name="imageFormat{{i}}">
                <mat-option *ngFor="let fmt of imageFormats" [value]="fmt.value">{{ fmt.label }}</mat-option>
              </mat-select>
            </mat-form-field>
          </mat-card-content>
        </mat-card>
      </ng-container>
      <button mat-raised-button color="primary" (click)="addImage()" style="margin-top: 1rem; align-self: flex-start;">
        <mat-icon>add</mat-icon> Add Image
      </button>
    </div>
  </mat-card-content>
</mat-card>
